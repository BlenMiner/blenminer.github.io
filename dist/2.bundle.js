(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{107:function(e,t,n){"use strict";var r=n(33);n.n(r).a},108:function(e,t,n){(e.exports=n(4)(!1)).push([e.i,"\ntable.aclTable[data-v-1b770dc2] {\n    border-collapse: collapse;\n    width: 100%;\n}\ntable.aclTable > tbody > tr > td[data-v-1b770dc2],\ntable.aclTable > thead > tr > th[data-v-1b770dc2] {\n    padding: 0.2em;\n    border: 1px solid lightgrey;\n    text-align: center;\n}\n.userCard[data-v-1b770dc2] {\n    border: 1px solid lightgrey;\n    min-width: 8em;\n    position: relative;\n}\n.userPhoto[data-v-1b770dc2] {\n    background-color: lightgrey;\n    clip-path: circle(50%);\n    height: 4em;\n    width: 4em;\n}\n.userPhoto.addBtn[data-v-1b770dc2] {\n    background-color: white;\n    border: 1px solid lightgrey;\n    border-radius: 50%;\n}\n.userCard .deleteUserACL[data-v-1b770dc2] {\n    color: lightgrey;\n    position: absolute;\n    top: 0em;\n    right: 0em;\n}\n.userCard .deleteUserACL[data-v-1b770dc2]:hover {\n    color: red;\n}\n",""])},112:function(e,t,n){"use strict";var r=n(35);n.n(r).a},113:function(e,t,n){(e.exports=n(4)(!1)).push([e.i,"\n.settingsPanel {\n    position: absolute;\n    top: 0px;\n    left: 0px;\n    right: 0px;\n    bottom: 0px;\n    background-color: #fffffff6;\n    z-index: 5;\n    overflow-y: auto;\n}\n.settingsPanel h1,\n.settingsPanel h2 {\n    text-align: center;\n    background-color: #005685; /* ds blue */\n    color: white;\n    clip-path: polygon(0em 0em, calc(100% - 1em) 0%, 100% 1em, 100% 100%, 0.5em 100%, 0% calc(100% - 0.5em));\n    margin-bottom: 0.5em;\n}\n.settingsPanel h2 {\n    font-size: 1.25em;\n}\n.imgPreview {\n    position: relative;\n    border: 1px solid lightgrey;\n    padding: 0.5em;\n    margin: 0.2em;\n    height: 7em;\n    width: 7em;\n}\n.imgPreview .row,\n.imgPreview .v-image {\n    height: 100%;\n    width: 100%;\n}\n.imgPreview .deleteIcon {\n    position: absolute;\n    top: 0px;\n    right: 0px;\n}\n.imgPreview .imgOrderIcon {\n    position: absolute;\n    bottom: 0%;\n    height: 1.5em;\n    width: 1.5em;\n    color: white;\n    background-color: #0b407c;\n    cursor: pointer;\n}\n.imgPreview .imgOrderIcon.leftArrow {\n    left: 0px;\n    clip-path: polygon(0em 0em, 100% 100%, 0% 100%);\n}\n.imgPreview .imgOrderIcon.rightArrow {\n    right: 0px;\n    clip-path: polygon(0em 100%, 100% 0em, 100% 100%);\n}\n.imgPreview .imgOrderIcon > i.v-icon {\n    position: absolute;\n    bottom: 0.1em;\n    font-size: 0.9em;\n}\n.imgPreview .imgOrderIcon.leftArrow > i.v-icon {\n    left: 0px;\n}\n.imgPreview .imgOrderIcon.rightArrow > i.v-icon {\n    right: 0px;\n}\n.dropZoneGrow {\n    padding: 0.5em;\n    margin: 0.2em;\n    height: 7em;\n    vertical-align: middle;\n    line-height: 2em;\n    box-sizing: border-box;\n    padding-top: 2em;\n    min-width: 15em;\n}\n.processing {\n    position: relative;\n    animation-name: updown;\n    animation-duration: 2s;\n    animation-iteration-count: infinite;\n}\n@keyframes updown {\n0% {\n        top: -0.5em;\n}\n50% {\n        top: 0.5em;\n}\n100% {\n        top: -0.5em;\n}\n}\n",""])},124:function(e,t,n){"use strict";var r=n(37);n.n(r).a},125:function(e,t,n){(e.exports=n(4)(!1)).push([e.i,"\n.imageContain .v-image__image {\n    background-size: contain;\n}\n.overlayIcons {\n    position: absolute;\n    z-index: 10;\n    top: 0.5em;\n    right: 1em;\n    display: none;\n}\nbody:hover .overlayIcons,\n.showIcon.overlayIcons,\n.isTouch .overlayIcons {\n    display: block;\n}\n",""])},147:function(e,t,n){var r=n(148);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(13)(r,o);r.locals&&(e.exports=r.locals)},148:function(e,t,n){(e.exports=n(4)(!1)).push([e.i,"html,\nbody {\n    overflow-y: hidden;\n    height: 100%;\n}",""])},25:function(e,t,n){var r=n(58);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(13)(r,o);r.locals&&(e.exports=r.locals)},3:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(7),i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app",{class:e.isTouch?"isTouch":"",staticStyle:{height:"100%",position:"relative","background-color":"#fff"}},[n("v-carousel",{attrs:{cycle:e.ui.cycleImages,height:e.ui.height,"hide-delimiters":e.ui.hideBullets,"hide-delimiter-background":"",interval:e.ui.interval,"show-arrows":e.showNavigationArrows,"show-arrows-on-hover":e.showNavigationArrowsOnHover}},e._l(e.listImgSrc,(function(t,r){return n("v-carousel-item",{key:r,class:"contain"===e.ui.displayMode?"imageContain":"",attrs:{src:t.src}})})),1),e._v(" "),e.isLoading||e.listImgSrc&&!(e.listImgSrc.length<=0)?e._e():n("div",[e._v("\n        No images to display"),n("br"),e._v("\n        Either you don't have the read accesses to this gallery or the gallery is empty."),n("br"),e._v(" "),e.$options.widget.readOnly?n("span",[e._v("Widget is in Read Only mode, ask a Dashboard Owner to update the setting to add you read access to this gallery")]):n("span",[e._v("Check the settings with the "),n("v-icon",[e._v("edit")]),e._v(" on the top right.")],1)]),e._v(" "),e.ui.showSettings&&!e.$options.widget.readOnly?n("settings",{on:{"refresh-data":e.refreshImages,"init-db":e.initAndLoad,"create-gallery":e.addNewGallery,"delete-gallery":e.deleteGallery}}):e._e(),e._v(" "),e.$options.widget.readOnly?e._e():n("div",{staticClass:"overlayIcons",class:e.ui.showSettings?"showIcon":""},[e.ui.showSettings?n("v-icon",{on:{click:function(t){e.ui.showSettings=!e.ui.showSettings}}},[e._v("close")]):n("v-icon",{on:{click:function(t){e.ui.showSettings=!e.ui.showSettings}}},[e._v("edit")])],1)],1)};i._withStripped=!0;var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"settingsPanel pa-8"},[n("h1",[e._v("Widget Configuration")]),e._v(" "),n("v-row",{staticClass:"ma-0 pb-8",attrs:{"no-gutters":""}},[e.isSetByAdmin?e._e():n("v-col",{attrs:{cols:"12"}},[n("v-text-field",{attrs:{label:"CouchDB Server URL"},model:{value:e.couchDBUrl,callback:function(t){e.couchDBUrl=t},expression:"couchDBUrl"}})],1),e._v(" "),e.isSetByAdmin||e.isTrusted?e._e():n("v-col",{attrs:{cols:"12"}},[n("v-text-field",{attrs:{label:"Tenant ID"},model:{value:e.tenantId,callback:function(t){e.tenantId=t},expression:"tenantId"}})],1),e._v(" "),e.isSetByAdmin||e.isTrusted?e._e():n("v-col",{attrs:{cols:"12"}},[n("v-text-field",{attrs:{label:"3DSwym Service Url"},model:{value:e.swymUrl,callback:function(t){e.swymUrl=t},expression:"swymUrl"}})],1),e._v(" "),n("v-col",{attrs:{cols:"auto"}},[n("v-select",{attrs:{items:e.listGalleries,"item-text":"name","item-value":"idDb",label:"My Galleries"},model:{value:e.selectedGalleryNow,callback:function(t){e.selectedGalleryNow=t},expression:"selectedGalleryNow"}})],1),e._v(" "),n("v-col",{attrs:{cols:"auto"}},[n("v-btn",{attrs:{icon:""},on:{click:e.addNewGallery}},[n("v-icon",[e._v("add")])],1),e._v(" "),e.myacl.a&&e.selectedGalleryObj?n("v-btn",{attrs:{icon:""},on:{click:e.deleteGallery}},[n("v-icon",[e._v("delete")])],1):e._e()],1),e._v(" "),n("v-col",{attrs:{cols:"12"}},[n("h2",[e._v("Gallery Configuration")])]),e._v(" "),n("v-col",{attrs:{cols:"12"}}),e._v(" "),e.selectedGalleryObj&&e.myacl.u?n("v-col",{attrs:{cols:"auto"}},[n("v-text-field",{attrs:{label:"Gallery Name"},model:{value:e.selectedGalleryObj.name,callback:function(t){e.$set(e.selectedGalleryObj,"name",t)},expression:"selectedGalleryObj.name"}})],1):e._e(),e._v(" "),e.selectedGalleryObj&&e.myacl.u?n("v-col",{attrs:{cols:"auto"}},[n("v-btn",{attrs:{icon:""},on:{click:e.saveGalleryName}},[n("v-icon",[e._v("save")])],1)],1):e._e(),e._v(" "),n("v-col",{staticClass:"mr-4",attrs:{cols:"auto"}},[n("v-switch",{staticClass:"mr-2",attrs:{color:"primary",label:"Hide bullets"},model:{value:e.ui.hideBullets,callback:function(t){e.$set(e.ui,"hideBullets",t)},expression:"ui.hideBullets"}})],1),e._v(" "),n("v-col",{staticClass:"mr-4",attrs:{cols:"auto"}},[n("v-switch",{staticClass:"mr-2",attrs:{color:"primary",label:"Cycles through the images"},model:{value:e.ui.cycleImages,callback:function(t){e.$set(e.ui,"cycleImages",t)},expression:"ui.cycleImages"}})],1),e._v(" "),e.ui.cycleImages?n("v-col",{staticClass:"mr-4",attrs:{cols:"auto"}},[n("v-text-field",{staticClass:"mr-2",attrs:{type:"number",label:"Cycle time (in ms)"},model:{value:e.ui.interval,callback:function(t){e.$set(e.ui,"interval",t)},expression:"ui.interval"}})],1):e._e(),e._v(" "),n("v-col",{attrs:{cols:"auto"}},[n("v-select",{attrs:{items:["contain","cover"],label:"Display mode"},model:{value:e.ui.displayMode,callback:function(t){e.$set(e.ui,"displayMode",t)},expression:"ui.displayMode"}})],1),e._v(" "),n("v-col",{staticClass:"mt-4",attrs:{cols:"12"}},[n("h2",[e._v("Gallery Content")])]),e._v(" "),n("v-col",{attrs:{cols:"12"}}),e._v(" "),e._l(e.listImgSrc,(function(t,r){return n("v-col",{key:r,staticClass:"imgPreview",attrs:{cols:"auto"}},[n("v-row",{staticClass:"ma-0 pa-0",attrs:{align:"center",justify:"center"}},[n("v-img",{attrs:{src:t.src,"max-width":"100%","max-height":"100%",contain:""}})],1),e._v(" "),e.myacl.d?n("v-icon",{staticClass:"deleteIcon ma-0",attrs:{small:""},on:{click:function(n){return e.deleteDoc(t)}}},[e._v("mdi-delete")]):e._e(),e._v(" "),r>0&&e.myacl.u?n("div",{staticClass:"imgOrderIcon leftArrow",on:{click:function(n){return e.reorderDocBefore(t,r)}}},[n("v-icon",{staticClass:"leftIcon ma-0 pa-0",attrs:{color:"white"}},[e._v("arrow_back")])],1):e._e(),e._v(" "),r<e.listImgSrc.length-1&&e.myacl.u?n("div",{staticClass:"imgOrderIcon rightArrow",on:{click:function(n){return e.reorderDocAfter(t,r)}}},[n("v-icon",{staticClass:"rightIcon ma-0 pa-0",attrs:{color:"white"}},[e._v("arrow_forward")])],1):e._e()],1)})),e._v(" "),e.myacl.c?n("v-col",{staticClass:"grow"},[n("drop-zone",{staticClass:"dropZoneGrow",on:{"drop-on":e.dropObject}},[n("v-icon",{class:e.fileProcessingCount>0?"processing":""},[e._v("save_alt")]),e._v(" Drop an image here to upload it\n                "),n("v-icon",{class:e.fileProcessingCount>0?"processing":""},[e._v("save_alt")])],1)],1):e._e(),e._v(" "),e.myacl.a?n("v-col",{staticClass:"mt-4",attrs:{cols:"12"}},[n("h2",[e._v("Gallery Access Control List")])]):e._e(),e._v(" "),n("v-col",{attrs:{cols:"12"}},[e.myacl.a?n("acl-display",{on:{"acl-update":function(t){return e.loadMyAclForDB(e.selectedGalleryNow)}}}):e._e()],1)],2)],1)};a._withStripped=!0;var s=function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{class:["dropZone",e.dragOver?" dragOver":""],on:{dragenter:function(t){t.stopPropagation(),e.dragOver=!0},dragleave:function(t){t.stopPropagation(),e.dragOver=!1},dragover:function(t){t.preventDefault(),t.stopPropagation(),e.dragOver=!0},drop:function(t){return t.preventDefault(),t.stopPropagation(),e.drop(t)}}},[e._t("default",[e._v("Drop an object here")])],2)};s._withStripped=!0;var l={name:"DropZone",data:function(){return{dragOver:!1}},methods:{drop:function(e){this.dragOver=!1,e&&e.dataTransfer?this.$emit("drop-on",e):console.warn("Drop not managed, no dataTransfer found")}}},c=(n(57),n(16)),u=Object(c.a)(l,s,[],!1,null,null,null);u.options.__file="src/components/drop-zone.vue";var d=u.exports,f=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",["pending"===e.saveState||"loading"===e.saveState?n("v-progress-circular",{attrs:{indeterminate:"",size:"12",color:"primary"}}):e._e()],1),e._v(" "),e.loading?n("div",[e._v("Loading...")]):n("div",[n("v-row",{attrs:{"no-gutters":""}},[e._l(e.userList,(function(t,r){return n("v-col",{key:"aclUser-"+r,staticClass:"userCard mr-2 pa-1",attrs:{cols:"auto"}},[n("v-row",{attrs:{"no-gutters":""}},[n("v-col",{staticClass:"userPhoto",attrs:{cols:"auto"}},[n("img",{staticStyle:{width:"100%"},attrs:{src:e.swymUrl+"/api/user/getpicture/login/"+t+"/format/normal"}})]),e._v(" "),n("v-col",{staticClass:"userInfos pl-2",attrs:{cols:"auto"}},[n("v-row",{staticStyle:{"padding-right":"1em"},attrs:{"no-gutters":""}},[e._v(e._s(e.userDisplayMap[t]||t))]),e._v(" "),n("v-row",{staticClass:"userRole",attrs:{"no-gutters":""}},[n("v-select",{staticClass:"pt-0",staticStyle:{width:"8em"},attrs:{items:e.listRoles,"item-text":"display","item-value":"value","hide-details":""},model:{value:e.aclInfos.users[t],callback:function(n){e.$set(e.aclInfos.users,t,n)},expression:"aclInfos.users[user]"}})],1)],1)],1),e._v(" "),n("v-icon",{staticClass:"deleteUserACL",attrs:{small:""},on:{click:function(n){return e.deleteUserACL(t)}}},[e._v("delete")])],1)})),e._v(" "),n("v-col",{staticClass:"userCard mr-2 pa-1",attrs:{cols:"auto"}},[n("v-row",{attrs:{"no-gutters":""}},[n("v-col",{staticClass:"userPhoto addBtn",staticStyle:{"text-align":"center","vertical-align":"middle","line-height":"3.75em",cursor:"pointer"},attrs:{cols:"auto"},on:{click:e.addUserACL}},[n("v-icon",{attrs:{big:""}},[e._v("add")])],1),e._v(" "),n("v-col",{staticClass:"userInfos pl-2",attrs:{cols:"auto"}},[n("v-row",{attrs:{"no-gutters":""}},[n("swym-user-finder",{staticClass:"ma-0 pt-0",attrs:{"swym-url":e.swymUrl,label:"Add User"},model:{value:e.tempUserId,callback:function(t){e.tempUserId=t},expression:"tempUserId"}})],1),e._v(" "),n("v-row",{staticClass:"userRole",attrs:{"no-gutters":""}},[n("v-select",{staticClass:"pt-0",staticStyle:{width:"8em"},attrs:{items:e.listRoles,"item-text":"display","item-value":"value","hide-details":""},model:{value:e.newAcl,callback:function(t){e.newAcl=t},expression:"newAcl"}})],1)],1)],1)],1)],2)],1)])};f._withStripped=!0;var h=n(17),m=function(e){var t=e.method,n=void 0===t?"GET":t,r=e.url,o=e.data,i=e.dataType,a=void 0===i?"json":i,s=e.type,l=void 0===s?"json":s,c=(e.withCredentials,e.headers),u=void 0===c?{}:c;return u&&!u["Content-Type"]&&"json"===a&&(u["Content-Type"]="application/json"),"application/json"===u["Content-Type"]&&(o=JSON.stringify(o)),new Promise((function(e,t){requirejs(["DS/WAFData/WAFData"],(function(i){i.authenticatedRequest(r,{method:n,headers:u,data:o,type:l,dataType:a,onComplete:function(t){e(t)},onFailure:function(e){t(e)}})}))}))},p={baseUrl:"http://localhost:5984/",createDb:function(e,t){m({method:"PUT",url:this.baseUrl+e,type:"json",withCredentials:!0}).then((function(e){try{e.ok?t():console.error("Impossible to create DB")}catch(e){console.error(e)}})).catch((function(e){console.error(e)}))},deleteDb:function(e,t){m({method:"DELETE",url:this.baseUrl+e,type:"json",withCredentials:!0}).then((function(e){try{e.ok?t():console.error("Impossible to delete DB")}catch(e){console.error(e)}})).catch((function(e){console.error(e)}))},createDocument:function(e,t,n){m({method:"POST",url:this.baseUrl+e,data:t,type:"json",withCredentials:!0}).then((function(e){e.ok?n(e):console.error("Impossible to create Document")})).catch((function(e){console.error(e)}))},readDocument:function(e,t,n){m({method:"GET",url:this.baseUrl+e+"/"+t,type:"json",withCredentials:!0}).then((function(e){n(e)})).catch((function(e){console.error(e)}))},updateDocument:function(e,t,n,r){var o=t._id;m({method:"PUT",url:this.baseUrl+e+"/"+o,data:t,type:"json",withCredentials:!0}).then((function(e){e.ok?n(e):("function"==typeof r&&r(e),console.error("Impossible to Update Document"))})).catch((function(e){"function"==typeof r&&r(e),console.error(e)}))},deleteDocument:function(e,t,n,r){m({method:"DELETE",url:this.baseUrl+e+"/"+t._id+"?rev="+t._rev,type:"json",withCredentials:!0}).then((function(e){e.ok?n(e):("function"==typeof r&&r(e),console.error("Impossible to Delete Document"))})).catch((function(e){"function"==typeof r&&r(e),console.error(e)}))},getDocumentAttachment:function(e,t,n,r){m({method:"GET",url:this.baseUrl+e+"/"+t+"/"+n,type:"raw",withCredentials:!0}).then((function(e){r(e)})).catch((function(e){console.error(e)}))},putDocumentAttachment:function(e,t,n,r,o,i,a){m({method:"PUT",url:this.baseUrl+e+"/"+t+"/"+r,data:o,dataType:"file",type:"json",withCredentials:!0,headers:{"If-Match":n}}).then((function(e){e.ok?i(e):("function"==typeof a&&a(e),console.error("Impossible to Update Document"))})).catch((function(e){"function"==typeof a&&a(e),console.error(e)}))},getAllDocs:function(e,t,n,r){this.getAllViewDocs(e,"_all_docs",null,t,n,r)},getAllDocsResultPage:function(e,t,n,r,o){this.getViewMapResultPage(e,"_all_docs",t,null,n,null,r,o)},getAllViewDocs:function(e,t,n,r,o,i,a){var s=this,l=null,c=null,u=1e3;a&&a>=1&&a<u&&(u=a);var d=[];!function f(){s.getViewMapResultPage(e,t,u,n,l,c,r,(function(e){var t=e.total_rows,n=e.rows;if(d=d.concat(n),a&&a>=1&&(t=a),d.length<t&&n.length>0&&n.length>u)if(n.length<u&&n.length<=1)o(d);else{var r=d.pop();l=r.key,c=r.id,f(),i(d,t)}else o(d)}))}()},getViewMapResultPage:function(e,t,n,r,o,i,a,s){m({method:"GET",url:this.baseUrl+e+"/"+t+"?reduce=false&include_docs=true&limit="+(n+1)+(r?'&key="'.concat(r,'"'):"")+(o?'&startkey="'.concat(o,'"'):"")+(i?'&startkey_docid="'.concat(i,'"'):"")+"&"+a,type:"json",withCredentials:!0}).then((function(e){s(e)})).catch((function(e){console.error(e)}))},getViewReduceInfos:function(e,t,n){m({method:"GET",url:this.baseUrl+e+"/"+t+"?reduce=true&group=true",type:"json",withCredentials:!0}).then((function(e){n(e)})).catch((function(e){console.error(e)}))},getACL:function(e){return m({method:"GET",url:this.baseUrl+e+"/_acl",type:"json",withCredentials:!0})},saveACL:function(e,t){return m({method:"POST",url:this.baseUrl+e+"/_acl",type:"json",data:t,withCredentials:!0})},getMyACL:function(e){return m({method:"GET",url:this.baseUrl+e+"/_myacl",type:"json",withCredentials:!0})},updateOwnership:function(e,t,n){return m({method:"POST",url:this.baseUrl+e+"/_ownership",type:"json",data:{_id:t,owner:n},withCredentials:!0})}};function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}if(!widget)throw new Error("Widget Global variable not available, load this module only once widget is declared.");var y="__platformTenant",w="",b={},O=!1,_={onTenantChange:[]},I=null;try{var D=top.location.href;""!==D&&D!==widget.getUrl()?I=!0:S()}catch(e){I=!1,S(),widget.addPreference({name:"ResetPrefsUntrustedWidget",type:"boolean",label:"Widget Unstrusted, Reset saved Platform Informations (tenant, urls,...)",defaultValue:!1,onchange:"onChangeResetPrefsUntrustedWidget"}),widget.setValue("ResetPrefsUntrustedWidget",!1),widget.addEvent("onChangeResetPrefsUntrustedWidget",(function(e,t){"ResetPrefsUntrustedWidget"===e&&t&&"false"!==t&&(widget.setValue("ResetPrefsUntrustedWidget",!1),widget.dispatchEvent("onEdit"),O=!1,w=null,b={},widget.setValue("__savedServicesForUntrustedMode",JSON.stringify(b)),S())}))}function S(){try{b=JSON.parse(widget.getValue("__savedServicesForUntrustedMode"))}catch(e){b={},widget.setValue("__savedServicesForUntrustedMode",JSON.stringify(b))}(w=(Object.keys(b)||[])[0])||""===w||(w=widget.getValue(y)||"DSEXT001",b[w]={},widget.setValue("__savedServicesForUntrustedMode",JSON.stringify(b)))}function C(e,t){e===y&&(w=t,widget.setValue(y,w),_.onTenantChange.forEach((function(e){e(w)})))}var j={isTrusted:function(){return I},isLoaded:function(){return O},getCurrentTenant:function(){return w},getTenant:function(e){return b[e]},setPreferedTenant:function(e){if(!b[e]){if(I)throw new Error("Invalid tenant (0x00) '".concat(e,"'"));b[e]={}}w=e,widget.setValue(y,e)},getUrlForTenantAndService:function(e,t){if(!b[e]){if(I)throw new Error("Invalid tenant (0x01) '".concat(e,"'"));if(S(),!b[e])throw new Error("Invalid tenant (0x02) '".concat(e,"'"))}return b[e][t]||(b[e][t]=widget.getValue("swymUrl")||"https://dsext001-eu1-215dsi0708-3dswym.3dexperience.3ds.com",widget.setValue("__savedServicesForUntrustedMode",JSON.stringify(b))),b[e][t]},setUrlForTenantAndService:function(e,t,n){if(I)throw new Error("setUrlForTenantAndService forbidden in trusted mode (0x03) '".concat(e,"', '").concat(t,"'"));b[e][t]=n},addEventListener:function(e,t){if(!_[e])throw new Error("Invalid event name '".concat(e,"'"));_[e].push(t)},removeEventListener:function(e,t){_[e].splice(_[e].indexOf(t),1)},reload3DExpUrls:function(){return O=!1,new Promise(I?function(e,t){var n=setTimeout((function(){t(new Error("i3DXCompassServices getPlatformServices : Timeout after 10 seconds."))}),1e4);requirejs(["DS/i3DXCompassServices/i3DXCompassServices"],(function(r){r.getPlatformServices({onComplete:function(t){clearTimeout(n),b=t.reduce((function(e,t){return e[t.platformId]=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t),e}),{});var r=widget.getPreference(y);r.options=t.map((function(e){return{label:e.displayName,value:e.platformId}})),r.type="list",widget.addPreference(r);var o=Object.keys(b);o.includes(w)?j.setPreferedTenant(w):j.setPreferedTenant(w=o[0]),O=!0,e()},onFailure:function(e){clearTimeout(n),t(new Error("i3DXCompassServices getPlatformServices onFailure"),e)}})}))}:function(e,t){O=!0,e("Untrusted Widget")})}};!function(){if(I){var e=widget.getPreference(y);void 0===e&&widget.addPreference({name:y,type:"hidden",label:"3DEXPERIENCE Platform",defaultValue:widget.getValue("x3dPlatformId")||""}),w=widget.getValue(y),(e=widget.getPreference(y)).type="hidden",e.onchange="onChangeConnector3DExpTenant",widget.addPreference(e),widget.setValue(y,w),widget.addEvent("onChangeConnector3DExpTenant",C)}}(),j.reload3DExpUrls().catch((function(){var e;(e=console).error.apply(e,arguments)}));var P=j,U=null,G=!1,x={onTenantChange:[]},A={addEventListener:function(e,t){if(!x[e])throw new Error("Invalid event name '".concat(e,"'"));x[e].push(t)},getUrl:function(){var e=P.getCurrentTenant();return P.getUrlForTenantAndService(e,"3DSwym")},loadCSRFToken:function(){return new Promise((function(e,t){var n=function(){var n=A.getUrl()+"/api/index/tk",r={},o={};requirejs(["DS/WAFData/WAFData"],(function(i){i.authenticatedRequest(n,{method:"GET",headers:o,data:r,type:"json",onComplete:function(t){t.result&&t.result.ServerToken&&""!==t.result.ServerToken&&"ok"===t.result.tk&&(U=t.result.ServerToken,G=!0),e()},onFailure:function(e){t(new Error("Error while getting Swym CSRF token"),e)}})}))};P.isLoaded()?n():P.reload3DExpUrls().then((function(){n()}))}))},call3DSwym:function(e){var t=e.url,n=e.method,r=void 0===n?"GET":n,o=e.headers,i=void 0===o?{}:o,a=e.data,s=void 0===a?{}:a,l=e.type,c=void 0===l?"json":l;return new Promise((function(e,n){var o=function(){var o=A.getUrl()+t,a=s,l=i;l["x-ds-swym-csrftoken"]=U;var u=r,d=c;requirejs(["DS/WAFData/WAFData"],(function(t){t.authenticatedRequest(o,{method:u,headers:l,data:a,type:d,onComplete:function(t){e(t)},onFailure:function(e){console.error(e),n(new Error("Error while calling Swym service url : ".concat(o)))}})}))};G?o():A.loadCSRFToken().then((function(){o()})).catch((function(){var e;(e=console).error.apply(e,arguments)}))}))}};P.addEventListener("onTenantChange",(function(){G=!1,x.onTenantChange.forEach((function(e){e()}))})),A.loadCSRFToken().catch((function(){var e;(e=console).error.apply(e,arguments)}));var T=A,k=function(){var e=this,t=e.$createElement;return(e._self._c||t)("v-autocomplete",{attrs:{loading:e.loading,items:e.peopleItems,"item-text":"displayName","item-value":"login","search-input":e.search,"cache-items":"","hide-details":"",placeholder:e.label},on:{"update:searchInput":function(t){e.search=t},"update:search-input":function(t){e.search=t}},model:{value:e.select,callback:function(t){e.select=t},expression:"select"}})};k._withStripped=!0;var E={name:"SwymUserFinder",props:{swymUrl:{type:String,required:!0},label:{type:String,required:!1},value:{type:Object,required:!1}},data:function(){return{loading:!1,peopleItems:[],search:null,select:this.value}},watch:{search:function(e){e&&e!==this.select&&e.length>=3&&this.searchQuery(e)},select:function(e){this.$emit("input",e)}},methods:{searchQuery:function(e){var t=this;this.loading=!0,T.call3DSwym({method:"POST",url:"/api/user/search",headers:{"Content-Type":"application/json"},type:"json",data:JSON.stringify({params:{start:"0",limit:"10",query:e,locale:"en"}})}).then((function(e){t.peopleItems=e.result.map((function(e){return{login:e.login,displayName:"".concat(e.displayName," (").concat(e.login,")")}})),t.loading=!1})).catch((function(n){console.error("3DSwym /api/user/search ".concat(e," error"),n),t.peopleItems=[],t.loading=!1}))}}},L=n(19),V=n.n(L),N=n(158),B=Object(c.a)(E,k,[],!1,null,"730e9dba",null);function F(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}V()(B,{VAutocomplete:N.a}),B.options.__file="src/components/swym-user-finder.vue";var M={name:"ACLDisplay",components:{swymUserFinder:B.exports},props:{},data:function(){return{loading:!0,aclInfos:null,tempUserId:"",saveState:"none",listRoles:[{display:"Reader",value:{c:!1,r:!0,u:!1,d:!1,a:!1}},{display:"Contributor",value:{c:!0,r:!0,u:!0,d:!0,a:!1}},{display:"Owner",value:{c:!0,r:!0,u:!0,d:!0,a:!0}}],newAcl:{c:!1,r:!0,u:!1,d:!1,a:!1},swymUrl:null,userDisplayMap:{}}},computed:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?F(Object(n),!0).forEach((function(t){$(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({userList:function(){return Object.keys(this.aclInfos.users)},selectedGalleryObj:function(){var e=this;return this.listGalleries.filter((function(t){return t.idDb===e.selectedGallery}))[0]},galleryOwners:function(){var e=this.selectedGalleryObj&&this.selectedGalleryObj.owner||[];return"string"==typeof e&&(e=[e]),e},dbName:function(){return this.$store.state.storage.dbName}},Object(h.c)(["listGalleries","selectedGallery"])),watch:{aclInfos:{deep:!0,handler:function(){"pending"!==this.saveState&&"loading"!==this.saveState&&(this.saveState="needed"),this.refreshUserDisplayMap()}}},created:function(){this.loadACL(),this.loadSwymUrl()},methods:{loadACL:function(){var e=this;this.saveState="loading",p.getACL(this.selectedGallery).then((function(t){e.aclInfos=t,e.loading=!1,e.saveState="none"})).catch((function(){console.error("Impossible to load ACL")}))},saveACL:function(){var e=this;this.saveState="pending",p.saveACL(this.selectedGallery,this.aclInfos).then((function(t){t.ok?(e.loadACL(),e.$emit("acl-update")):console.error("Impossible to save ACL")})).catch((function(){console.error("Impossible to save ACL")}))},addUserACL:function(){this.$set(this.aclInfos.users,this.tempUserId,this.newAcl),this.addOwner(this.tempUserId),this.tempUserId=""},deleteUserACL:function(e){this.$delete(this.aclInfos.users,e),this.deleteOwner(e)},addOwner:function(e){var t=this,n=this.galleryOwners.slice(0);n.push(e),p.updateOwnership(this.dbName,this.selectedGalleryObj._id,n).then((function(){t.selectedGalleryObj.owner=n,t.saveACL()})).catch((function(e){console.error("Impossible to add Owner",e)}))},deleteOwner:function(e){var t=this;if(-1!==this.galleryOwners.indexOf(e)){var n=this.galleryOwners.slice(0);n.splice(this.galleryOwners.indexOf(e),1),p.updateOwnership(this.dbName,this.selectedGalleryObj._id,n).then((function(){t.selectedGalleryObj.owner=n,t.saveACL()})).catch((function(e){console.error("Impossible to delete Owner",e)}))}else this.saveACL()},loadSwymUrl:function(){this.swymUrl=T.getUrl()},refreshUserDisplayMap:function(){var e=this;this.userList.forEach((function(t){e.userDisplayMap[t]||T.call3DSwym({method:"GET",url:"/api/user/find/login/".concat(t),type:"json"}).then((function(n){var r="".concat(n.result.first_name," ").concat(n.result.last_name," (").concat(t,")");e.$set(e.userDisplayMap,t,r)})).catch((function(e){console.error("3DSwym /api/user/find/login/".concat(t," error"),e)}))}))}}},R=(n(107),n(159)),W=n(43),z=n(34),J=n(160),q=n(149),Z=Object(c.a)(M,f,[],!1,null,"1b770dc2",null);V()(Z,{VCol:R.a,VIcon:W.a,VProgressCircular:z.a,VRow:J.a,VSelect:q.a}),Z.options.__file="src/components/acl-display.vue";var X=Z.exports,H=n(42),K={getImageFileOrientation:function(e){return new Promise((function(t,n){var r=new FileReader;r.onloadend=function(){var e=new DataView(r.result),o=0,i=1;if(r.result.length<2||65496!==e.getUint16(o))n(new Error("Not a JPEG"));else{o+=2;for(var a=e.byteLength,s=!1;o<a-2;){var l=e.getUint16(o,s);switch(o+=2,l){case 65505:18761===e.getUint16(o+8)&&(s=!0),a=e.getUint16(o,s)+o,o+=2;break;case 274:i=e.getUint16(o+6,s),a=0}}t(i)}},r.readAsArrayBuffer(e)}))},getRotatedImageBlob:function(e){return new Promise((function(t,n){K.getImageFileOrientation(e).then((function(n){var r=new Image;r.onload=function(){var e=r.naturalWidth,o=r.naturalHeight,i=e,a=o;-1!==[5,6,7,8].indexOf(n)&&(a=e,i=o);var s=document.createElement("canvas");s.width=i,s.height=a;var l=s.getContext("2d");switch(n){case 2:l.translate(e,0),l.scale(-1,1);break;case 3:l.translate(e,o),l.rotate(Math.PI);break;case 4:l.translate(0,o),l.scale(1,-1);break;case 5:l.rotate(Math.PI/2),l.scale(1,-1);break;case 6:l.rotate(Math.PI/2),l.translate(0,-1*o);break;case 7:l.rotate(Math.PI/2),l.translate(e,-1*o),l.scale(-1,1);break;case 8:l.rotate(-1*Math.PI/2),l.translate(-1*e,0)}l.drawImage(r,0,0),s.toBlob((function(e){t(e),s.remove()}),"image/jpeg",.95)},r.src=URL.createObjectURL(e)})).catch((function(e){n(e)}))}))}},Q=K;function Y(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(n),!0).forEach((function(t){ne(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ne(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var re={name:"Settings",components:{dropZone:d,aclDisplay:X},props:{},data:function(){return{couchDBUrl:p.baseUrl,debouncer:{couchDBUrl:null,tenantId:null,swymUrl:null},selectedGalleryNow:this.$store.state.selectedGallery,myacl:{c:!1,r:!1,u:!1,d:!1,a:!1},fileProcessingCount:0,isSetByAdmin:!1,isTrusted:P.isTrusted(),tenantId:P.getCurrentTenant(),swymUrl:P.getUrlForTenantAndService(P.getCurrentTenant(),"3DSwym")}},computed:te({ui:function(){return this.$store.state.ui},listImgSrc:function(){return this.$store.state.listImgSrc},selectedGalleryObj:function(){var e=this;return this.listGalleries.filter((function(t){return t.idDb===e.selectedGallery}))[0]},dbName:function(){return this.$store.state.storage.dbName}},Object(h.c)(["listGalleries","selectedGallery"])),watch:{couchDBUrl:function(e){var t=this;widget.setValue("couchDbUrl",e),this.debouncer.couchDBUrl&&Object(H.clearTimeout)(this.debouncer.couchDBUrl),this.debouncer.couchDBUrl=Object(H.setTimeout)((function(){e.lastIndexOf("/")!==e.length-1?(e+="/",t.couchDBUrl=e):(p.baseUrl=e,t.initAndLoad(),t.debouncer.couchDBUrl=null)}),2e3)},selectedGalleryNow:function(e){this.$store.dispatch("selectGallery",{widget:widget,selectedGallery:e}),this.loadMyAclForDB(e)},tenantId:function(e){var t=this;this.debouncer.tenantId&&Object(H.clearTimeout)(this.debouncer.tenantId),this.debouncer.tenantId=Object(H.setTimeout)((function(){P.setPreferedTenant(e),P.setUrlForTenantAndService(e,"3DSwym",t.swymUrl)}),2e3)},swymUrl:function(e){var t=this;this.debouncer.swymUrl&&Object(H.clearTimeout)(this.debouncer.swymUrl),this.debouncer.swymUrl=Object(H.setTimeout)((function(){P.setUrlForTenantAndService(t.tenantId,"3DSwym",e)}),2e3)}},created:function(){this.loadMyAclForDB(this.selectedGalleryNow);var e=widget.getValue("adminSetup");this.isSetByAdmin=e&&(!0===e||"true"===e)},methods:te({dropObject:function(e){for(var t=e.dataTransfer.types,n=[],r=0;r<t.length;r++){var o=t[r];n.push(o)}if(-1!==n.indexOf("Files")){var i=e.dataTransfer.files;this.addFiles(i)}},addFiles:function(e){for(var t=0;t<e.length;t++)this.addFile(e[t])},addFile:function(e){var t=this,n=e.type,r={type:"File",mime:n,title:e.name,path:[],order:Math.max.apply(Math,Y(this.listImgSrc.map((function(e){return e.order}))))+1};-1!==n.indexOf("image/")?(this.fileProcessingCount++,"image/jpeg"===n?Q.getRotatedImageBlob(e).then((function(n){p.createDocument(t.selectedGallery,r,(function(r){p.putDocumentAttachment(t.selectedGallery,r.id,r.rev,e.name,n,(function(){t.refreshImages(),t.fileProcessingCount--}),(function(e){console.error("Doc upload KO",e),t.refreshImages()}))}))})).catch((function(e){console.error("getRotatedImageBlob KO",e),t.refreshImages()})):p.createDocument(this.selectedGallery,r,(function(n){p.putDocumentAttachment(t.selectedGallery,n.id,n.rev,e.name,e,(function(){t.refreshImages(),t.fileProcessingCount--}),(function(e){console.error("Doc upload KO",e),t.refreshImages()}))}))):alert("Please drop image files only.")},initAndLoad:function(){this.$emit("init-db")},addNewGallery:function(){this.$emit("create-gallery",{idDb:"mg-"+Date.now(),name:"New Gallery 01"})},deleteGallery:function(){this.$emit("delete-gallery")},saveGalleryName:function(){var e=this;p.updateDocument(this.dbName,this.selectedGalleryObj,(function(){e.refreshListGalleries()}))},deleteDoc:function(e){var t=this;p.deleteDocument(this.selectedGallery,e,(function(){t.refreshImages()}))},reorderDocBefore:function(e,t){var n=this,r=this.listImgSrc[t-1].order,o=0;t>1&&(o=this.listImgSrc[t-2].order||0),e.order=r-(r-o)/2,p.updateDocument(this.selectedGallery,e,(function(){n.refreshImages()}))},reorderDocAfter:function(e,t){var n=this,r=this.listImgSrc[t+1].order,o=Math.max.apply(Math,Y(this.listImgSrc.map((function(e){return e.order}))))+1;t<this.listImgSrc.length-2&&(o=this.listImgSrc[t+2].order||o),e.order=r+(o-r)/2,p.updateDocument(this.selectedGallery,e,(function(){n.refreshImages()}))},loadMyAclForDB:function(e){var t=this;this.myacl={c:!1,r:!1,u:!1,d:!1,a:!1},e&&p.getMyACL(e).then((function(e){t.myacl=e})).catch((function(e){console.error("Impossible to load MyACL",e)}))}},Object(h.b)(["refreshListGalleries","refreshImages"]))},oe=(n(112),n(53)),ie=n(164),ae=n(165),se=n(50),le=Object(c.a)(re,a,[],!1,null,null,null);function ce(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ue(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ce(Object(n),!0).forEach((function(t){de(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ce(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function de(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}V()(le,{VBtn:oe.a,VCol:R.a,VIcon:W.a,VImg:ie.a,VRow:J.a,VSelect:q.a,VSwitch:ae.a,VTextField:se.a}),le.options.__file="src/components/settings.vue";var fe={name:"App",components:{settings:le.exports},data:function(){return{isLoading:!0,isTouch:!1}},computed:ue({showNavigationArrows:function(){return this.listImgSrc.length>1},showNavigationArrowsOnHover:function(){return!this.isTouch&&this.listImgSrc.length>1},message:function(){return this.$store.state.message},ui:function(){return this.$store.state.ui},listImgSrc:function(){return this.$store.state.listImgSrc},dbName:function(){return this.$store.state.storage.dbName},selectedGalleryObj:function(){var e=this;return this.listGalleries.filter((function(t){return t.idDb===e.selectedGallery}))[0]}},Object(h.c)(["listGalleries","selectedGallery"])),watch:{ui:{deep:!0,handler:function(){widget.setValue("uiPrefs",JSON.stringify(this.ui))}}},created:function(){this.$options.widget=widget},mounted:function(){var e=this;window.addEventListener("resize",this.resize.bind(this)),this.resize(),this.initAndLoad();window.addEventListener("touchstart",(function t(){e.isTouch=!0,window.removeEventListener("touchstart",t)}),!1),setTimeout((function(){e.isLoading=!1}),3e3)},methods:ue({resize:function(){var e=document.body.getBoundingClientRect();this.$store.state.ui.height=e.height},initAndLoad:function(){var e=this;this.checkInitDB(this.dbName,(function(){e.refreshListGalleries(),e.refreshImages()}))},addNewGallery:function(e){var t=this;this.checkInitDB(e.idDb,(function(n){n&&p.createDocument(t.dbName,e,(function(n){t.refreshListGalleries(),t.$store.dispatch("selectGallery",{widget:widget,selectedGallery:e.idDb})}))}))},deleteGallery:function(){var e=this,t=this.selectedGalleryObj;t&&p.deleteDb(t.idDb,(function(){p.deleteDocument(e.dbName,t,(function(){e.refreshListGalleries(),e.$store.dispatch("selectGallery",{widget:widget,selectedGallery:null})}),(function(t){console.error("Delete Gallery Doc KO, but DB of the gallery deleted, conflict to clean",t),e.refreshListGalleries(),e.$store.dispatch("selectGallery",{widget:widget,selectedGallery:null})}))}))},selectGallery:function(e){this.$store.dispatch("selectGallery",{widget:widget,selectedGallery:e})},checkInitDB:function(e,t){e&&m({method:"GET",url:p.baseUrl+"_all_dbs/",type:"json",withCredentials:!0}).then((function(n){-1===n.indexOf(e)?p.createDb(e,(function(){p.saveACL(e,{default:{c:!0,r:!0,u:!0,d:!0,a:!1}}).then((function(){console.debug("Default ACL set successfully")})).catch((function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];console.error("Impossible to set Default ACL",t)})),t(!0)})):t(!1)})).catch((function(e){console.error(e)}))}},Object(h.b)(["refreshListGalleries","refreshImages"]))},he=(n(124),n(161)),me=n(163),pe=n(166),ge=Object(c.a)(fe,i,[],!1,null,null,null);V()(ge,{VApp:he.a,VCarousel:me.a,VCarouselItem:pe.a,VIcon:W.a}),ge.options.__file="src/components/app.vue";var ve=ge.exports,ye=n(162);n(132),n(139);o.a.use(ye.a);var we=new ye.a({icons:{iconfont:"mdi"}});o.a.use(h.a);var be=new h.a.Store({state:{message:"",ui:{showSettings:!1,cycleImages:!1,height:200,hideBullets:!1,interval:6e3,displayMode:"contain"},storage:{dbName:"media-galleries"},listGalleries:[],selectedGallery:null,listImgSrc:[]},mutations:{setSelectedGallery:function(e,t){e.selectedGallery=t},setListGalleries:function(e,t){e.listGalleries=t},setListImgSrc:function(e,t){e.listImgSrc=t},setUiParameters:function(e,t){var n=t.cycleImages,r=t.hideBullets,o=t.interval,i=t.displayMode;e.ui.cycleImages=n||!1,e.ui.hideBullets=r||!1,e.ui.interval=o||7e3,e.ui.displayMode=i||"contain"}},getters:{},actions:{selectGallery:function(e,t){var n=e.commit,r=e.dispatch,o=t.widget,i=t.selectedGallery;n("setSelectedGallery",i),o.setValue("selectedGallery",i),r("refreshImages")},refreshListGalleries:function(e){var t=e.state,n=e.commit;p.getAllDocs(t.storage.dbName,"acl_filter=mine",(function(e){var t=e.map((function(e){return e.doc})).filter((function(e){return-1===e._id.indexOf("_design/")}));n("setListGalleries",t)}),(function(e,t){var r=e.map((function(e){return e.doc})).filter((function(e){return-1===e._id.indexOf("_design/")}));n("setListGalleries",r)}))},refreshImages:function(e){var t=e.state,n=e.commit;p.getAllDocs(t.selectedGallery,"",(function(e){var r=e.map((function(e){return e.doc})).filter((function(e){return-1===e._id.indexOf("_design/")&&-1!==e.mime.indexOf("image/")})).map((function(e){return e.src="".concat(p.baseUrl).concat(t.selectedGallery,"/").concat(e._id,"/").concat(e.title),e.order=e.order||1,e})).sort((function(e,t){return e.order-t.order}));n("setListImgSrc",r)}),(function(e,r){var o=e.map((function(e){return e.doc})).filter((function(e){return-1===e._id.indexOf("_design/")&&-1!==e.mime.indexOf("image/")})).map((function(e){return e.src="".concat(p.baseUrl).concat(t.selectedGallery,"/").concat(e._id,"/").concat(e.title),e.order=e.order||1,e})).sort((function(e,t){return e.order-t.order}));n("setListImgSrc",o)}))}}}),Oe=(n(147),{isInitialSetupDone:function(){var e=widget.getValue("__wdg_init_setup_done__");return!(!e||!0!==e&&"true"!==e)},doInitialSetup:function(){if(!Oe.isInitialSetupDone()){var e=widget.getUrl();if(-1!==e.indexOf("?"))e.split("?")[1].split("&").forEach((function(e){var t=e.split("="),n=t[0],r=decodeURIComponent(t[1]);widget.setValue(n,r),console.debug("Initial Setup param '".concat(n,"'=").concat(r))}));widget.setValue("__wdg_init_setup_done__",!0)}}}),_e=Oe;t.default=function(){widget.addEvent("onLoad",(function(){!function(){r.b.disableCSS(!0);var e=widget.getUrl();widget.setIcon(e.substring(0,e.lastIndexOf("/"))+"/static/images/icon.png");var t=function(e,t){void 0===widget.getPreference(e)&&widget.addPreference({name:e,type:"hidden",label:e,defaultValue:t})};t("couchDbUrl","https://your_server_url/couchdb/"),t("selectedGallery",null),t("uiPrefs","{}"),_e.doInitialSetup(),p.baseUrl=widget.getValue("couchDbUrl");var n=new o.a({store:be,vuetify:we,render:function(e){return e(ve)}});be.commit("setUiParameters",JSON.parse(widget.getValue("uiPrefs"))),be.commit("setSelectedGallery",widget.getValue("selectedGallery")),n.$mount("app")}()})),widget.addEvent("onRefresh",(function(){window.location.reload()}))}},33:function(e,t,n){var r=n(108);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(13)(r,o);r.locals&&(e.exports=r.locals)},35:function(e,t,n){var r=n(113);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(13)(r,o);r.locals&&(e.exports=r.locals)},37:function(e,t,n){var r=n(125);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(13)(r,o);r.locals&&(e.exports=r.locals)},57:function(e,t,n){"use strict";var r=n(25);n.n(r).a},58:function(e,t,n){(e.exports=n(4)(!1)).push([e.i,"\n.dropZone {\n    box-sizing: border-box;\n    text-align: center;\n    border: 4px dashed grey;\n}\n.dropZone.dragOver {\n    background-color: rgba(220, 240, 255, 0.5);\n    border: 1px dotted rgb(142, 206, 255);\n}\n",""])}}]);