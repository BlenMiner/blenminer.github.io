(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{138:function(t,e,a){"use strict";var n=a(37);a.n(n).a},139:function(t,e,a){(t.exports=a(6)(!1)).push([t.i,"\nhtml, body {\r\n    overflow-y: auto !important;\r\n    width: 100%;\r\n    padding: 0;\r\n    margin: 0;\r\n    background-color:#ffffff;\n}\r\n",""])},3:function(t,e,a){"use strict";a.r(e);var n=a(0),i=a(7),r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",[a("v-tabs",{attrs:{centered:"",dark:"","icons-and-text":""},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("v-tabs-slider"),t._v(" "),a("v-tab",{attrs:{href:"#tab-1"}},[t._v("\n            Accounts History\n            "),a("v-icon",[t._v("mdi-phone")])],1),t._v(" "),a("v-tab",{attrs:{href:"#tab-2"}},[t._v("\n            Dormant Accounts\n            "),a("v-icon",[t._v("mdi-sleep")])],1),t._v(" "),a("div",{attrs:{width:"200px"}},[a("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1)],1),t._v(" "),a("v-tabs-items",{model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("v-tab-item",{attrs:{value:"tab-1"}},[a("costumer-table",{attrs:{table:t.table,loadingbar:t.loadingbar,search:t.search}})],1),t._v(" "),a("v-tab-item",{attrs:{value:"tab-2"}},[a("dormant-table",{attrs:{table:t.dTable,loadingbar:t.dormantLoading,search:t.search}})],1)],1)],1)};r._withStripped=!0;var s=a(161);a(62),a(69);i.a.use(s.a);var l=new i.a,o=new s.a({icons:{iconfont:"mdi"}});function c(t,e){e=e||",";for(var a=new RegExp("(\\"+e+'|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\'+e+"\\r\\n]*))","gi"),n=[[]],i=null,r=null;i=a.exec(t);){var s=i[1];s.length&&s!==e&&n.push([]),r=i[2]?i[2].replace(new RegExp('""',"g"),'"'):i[3],n[n.length-1].push(r)}return n}var d=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"costumerTable"}},[null!==t.selected?a("v-dialog",{attrs:{scrollable:"","max-width":"60%"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[a("v-card",[a("v-card-title",[t._v("History "+t._s(t.selected.name))]),t._v(" "),a("v-card-text",{staticStyle:{height:"80vh"}},t._l(t.selected.history,(function(e,n){return a("v-card",{key:n,staticClass:"ma-1",attrs:{outlined:"",elevation:"5"}},[a("v-list-item",{attrs:{"three-line":""}},[a("v-list-item-content",[a("div",{staticClass:"overline text-right",staticStyle:{"user-select":"text"}},[t._v("\n                                DS Customer Number: "+t._s(e.dsCustomerNumber.replace(" ","").replace(" ","").replace(" ",""))+"\n                                "),a("br"),t._v("\n                                "+t._s(e.date.toLocaleString())+"\n                            ")]),t._v(" "),a("v-list-item-title",[a("h5",{staticStyle:{"user-select":"text"}},[t._v(t._s(e.subject))])]),t._v(" "),a("v-list-item-content",{staticStyle:{"user-select":"text"}},[t._v(t._s(e.description))])],1)],1)],1)})),1)],1)],1):t._e(),t._v(" "),a("v-card",{attrs:{flat:""}},[a("v-data-table",{attrs:{headers:t.headers,items:t.table,"items-per-page":15,dense:"","fixed-header":!0,loading:t.loadingbar,search:t.search,height:"calc(100vh - 131px)"},scopedSlots:t._u([{key:"item",fn:function(e){var n=e.item;return[a("tr",[a("td",[t._v(" "+t._s(n.clientID)+" ")]),t._v(" "),a("td",[t._v(" "+t._s(n.client)+" ")]),t._v(" "),a("td",[a("v-btn",{attrs:{width:"100%",value:"recent",small:""},on:{click:function(e){return t.expand(n)}}},[a("v-icon",[t._v("mdi-history")]),t._v(" "),a("span",[t._v("History")])],1)],1),t._v(" "),a("td",[t._v("\n                        "+t._s(n.lastActivity)+"\n                    ")])])]}}])})],1)],1)};d._withStripped=!0;var u={name:"CostumerTable",props:{table:Array,loadingbar:Boolean,search:String},data:function(){return{dialog:!1,selected:null,headers:[{text:"Client ID",value:"clientID"},{text:"Client",value:"client"},{text:"Subject"},{text:"Last Activity"}]}},methods:{expand:function(t){this.dialog=!0,this.selected=t}}},v=a(26),h=a(27),p=a.n(h),b=a(58),m=a(43),f=a(20),g=a(160),_=a(163),C=a(47),w=a(33),x=a(23),y=Object(v.a)(u,d,[],!1,null,null,null);p()(y,{VBtn:b.a,VCard:m.a,VCardText:f.a,VCardTitle:f.b,VDataTable:g.a,VDialog:_.a,VIcon:C.a,VListItem:w.a,VListItemContent:x.a,VListItemTitle:x.b}),y.options.__file="src/components/costumerTable.vue";var S=y.exports,L=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"dormantTable"}},[a("v-card",{attrs:{flat:""}},[a("v-data-table",{attrs:{headers:t.headers,items:t.table,"items-per-page":15,dense:"","fixed-header":!0,loading:t.loadingbar,search:t.search,height:"calc(100vh - 131px)"},scopedSlots:t._u([{key:"item",fn:function(e){var n=e.item;return[a("tr",[a("td",[t._v(" "+t._s(n.clientID)+" ")]),t._v(" "),a("td",[t._v(" "+t._s(n.client)+" ")]),t._v(" "),a("td",{staticClass:"text-center"},[a("v-chip",{staticStyle:{height:"90%",width:"100%","justify-content":"center"},attrs:{small:""}},[t._v(" "+t._s(n.ALC2019)+" ")])],1),t._v(" "),a("td",{staticClass:"text-center"},[a("v-chip",{staticStyle:{height:"90%",width:"100%","justify-content":"center"},attrs:{small:""}},[t._v(" "+t._s(n.YLC2019)+" ")])],1),t._v(" "),a("td",{staticClass:"text-center"},[a("v-chip",{staticStyle:{height:"90%",width:"100%","justify-content":"center"},attrs:{small:"",color:"yellow"}},[t._v(" "+t._s(n.RLC2019)+" ")])],1),t._v(" "),a("td",{staticClass:"text-center"},[a("v-chip",{staticStyle:{height:"90%",width:"100%","justify-content":"center"},attrs:{small:""}},[t._v(" "+t._s(n.ALC2018)+" ")])],1),t._v(" "),a("td",{staticClass:"text-center"},[a("v-chip",{staticStyle:{height:"90%",width:"100%","justify-content":"center"},attrs:{small:""}},[t._v(" "+t._s(n.YLC2018)+" ")])],1),t._v(" "),a("td",{staticClass:"text-center"},[a("v-chip",{staticStyle:{height:"90%",width:"100%","justify-content":"center"},attrs:{small:"",color:"yellow"}},[t._v(" "+t._s(n.RLC2018)+" ")])],1)])]}}])})],1)],1)};L._withStripped=!0;var T={name:"DormantTable",props:{table:Array,loadingbar:Boolean,search:String},data:function(){return{dialog:!1,selected:null,headers:[{text:"Client ID",value:"clientID"},{text:"Client",value:"client"},{text:"ALC 2019",value:"ALC2019"},{text:"YLC 2019",value:"YLC2019"},{text:"RLC 2019",value:"RLC2019"},{text:"ALC 2018",value:"ALC2018"},{text:"YLC 2018",value:"YLC2018"},{text:"RLC 2018",value:"RLC2018"}]}},methods:{}},D=a(50),V=Object(v.a)(T,L,[],!1,null,null,null);p()(V,{VCard:m.a,VChip:D.a,VDataTable:g.a}),V.options.__file="src/components/dormantTable.vue";var A={name:"App",components:{costumerTable:S,dormantTable:V.exports},data:function(){return{lastmodif:"",table:[],dTable:[],tab:null,search:"",loadingbar:!0,dormantLoading:!0,tenantId:-1,tenants:[]}},computed:{message:function(){return this.$store.state.message}},mounted:function(){var t=this,e=this;widget.name="",e.loadingbar=!0,e.dormantLoading=!0,l.$on("onSearch",(function(t){e.search=t})),l.$on("reloadwidget",(function(){e.reload()})),void 0===widget.id?e.tenantDataLoaded([{id:-1}]):requirejs(["DS/i3DXCompassServices/i3DXCompassServices"],(function(e){e.getPlatformServices({platformId:void 0,onComplete:t.tenantDataLoaded})}))},methods:{substring:function(t,e){if(void 0===t)return"";var a=t.substring(0,e);return a+(a.length<t.length?"...":"")},log:function(t){this.snackbarMsg=t,this.snackbar=!0},getCSRF:function(t,e){var a,n,i=this,r=i.tenants[i.tenantId]["3DSpace"];a=r+"/resources/v1/application/CSRF",n={onComplete:function(e){var a=JSON.parse(e);t(a.csrf.value)},onFailure:function(t){i.log(t),e()}},requirejs(["DS/WAFData/WAFData"],(function(t){t.authenticatedRequest(a,n)}))},reload:function(){var t=this,e=widget.getValue("_FileKey_");e||(e=window.location.search.substring(1)),t.loadingbar=!0,t.dormantLoading=!0,t.tenantId=widget.getValue("_CurrentTenantID_"),t.table=[],t.dTable=[];var a=new XMLHttpRequest;a.open("GET","https://bcracker.dev/widgets/dormant/activities.php?key="+e,!0),a.send(null),a.onload=function(){for(var e=c(a.responseText,";"),n={},i=1;i<e.length;++i)if(void 0!==e[i][11]){var r=e[i][3],s=e[i][11].split("/"),l=s[1]+"/"+s[0]+"/"+s[2],o=new Date(l),d=(((new Date).getTime()-o.getTime())/864e5).toFixed(0).toString()+" days ago",u={subject:e[i][6],description:e[i][7],dsCustomerNumber:e[i][5],date:o};if(void 0!==n[r]){var v=n[r];t.table[v].lastActivityDate=o,t.table[v].lastActivity=d,t.table[v].history.unshift(u)}else n[r]=t.table.length,t.table.push({client:r,clientID:e[i][4],partner:e[i][8],lastActivityDate:o,lastActivity:d,history:[u]})}t.table.sort((function(t,e){return t.client<e.client?-1:t.client<e.client?1:0})),t.loadingbar=!1};var n=new XMLHttpRequest;n.open("GET","https://bcracker.dev/widgets/dormant/p_activities.php?key="+e,!0),n.send(null),n.onload=function(){for(var e=c(n.responseText,";"),a=1;a<e.length;++a)if(!e[a][7]&&!e[a][12]){var i={clientID:e[a][0],client:e[a][1],industry:e[a][5],ALC2019:e[a][6],YLC2019:e[a][8],RLC2019:e[a][9],ALC2018:e[a][11],YLC2018:e[a][13],RLC2018:e[a][14]};t.dTable.push(i)}t.dTable.sort((function(t,e){return t.client<e.client?-1:t.client<e.client?1:0})),t.dormantLoading=!1}},tenantDataLoaded:function(t){this.tenants=[];for(var e=[],a=0,n=0;n<t.length;n++)void 0!==t[n]["3DSpace"]&&(e.push({value:"".concat(a++),label:"".concat(t[n].platformId," - ").concat(t[n].displayName)}),this.tenants.push(t[n]));widget.addPreference({name:"_CurrentTenantID_",type:"list",label:"Tenant",defaultValue:"0",options:e}),widget.addPreference({name:"_FileKey_",type:"text",label:"File Key",defaultValue:""}),l.$emit("reloadwidget")},getColor:function(t){return t%2==1?"white":"#EFEFEF"}}},I=(a(138),a(158)),k=a(159),R=a(164),j=a(162),E=a(151),F=a(148),$=a(150),Y=Object(v.a)(A,r,[],!1,null,null,null);p()(Y,{VApp:I.a,VIcon:C.a,VTab:k.a,VTabItem:R.a,VTabs:j.a,VTabsItems:E.a,VTabsSlider:F.a,VTextField:$.a}),Y.options.__file="src/components/app.vue";var q=Y.exports,H=a(149);i.a.use(H.a);var N=new H.a.Store({state:{},mutations:{},getters:{}});e.default=function(){widget.addEvent("onLoad",(function(){n.b.disableCSS(!0),window.title="Tablue Vue",widget.setTitle(window.title),new i.a({store:N,vuetify:o,render:function(t){return t(q)}}).$mount("app")})),widget.addEvent("onRefresh",(function(){l.$emit("reloadwidget")})),widget.addEvent("onSearch",(function(t){l.$emit("onSearch",t)})),widget.addEvent("onResetSearch",(function(){l.$emit("onSearch","")}))}},37:function(t,e,a){var n=a(139);"string"==typeof n&&(n=[[t.i,n,""]]);var i={insert:"head",singleton:!1};a(25)(n,i);n.locals&&(t.exports=n.locals)}}]);