(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{14:function(t,e,a){var s=a(38);"string"==typeof s&&(s=[[t.i,s,""]]);var r={insert:"head",singleton:!1};a(13)(s,r);s.locals&&(t.exports=s.locals)},3:function(t,e,a){"use strict";a.r(e);var s=a(0),r=a(4),i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",[a("v-card",{attrs:{flat:""}},[a("v-simple-table",{attrs:{dense:"","fixed-header":!0,height:"100vh"},scopedSlots:t._u([{key:"default",fn:function(){return[a("thead",[a("tr",[a("th",{staticClass:"text-left"},[t._v("Partner")]),t._v(" "),a("th",{staticClass:"text-left"},[t._v("Range")]),t._v(" "),a("th",{staticClass:"text-left"},[t._v("Total Credits")]),t._v(" "),a("th",{staticClass:"text-left"},[t._v("Total KPI")])])]),t._v(" "),a("tbody",t._l(t.sortedDatabase,(function(e,s){return a("tr",{key:s,style:{"background-color":t.getColor(s)}},[a("td",[t._v(t._s(e))]),t._v(" "),a("td",[a("b",{staticStyle:{color:"#a74796"}},[t._v(t._s(t.rangesData[e].min))]),t._v(" - "),a("b",{staticStyle:{color:"#4cb786"}},[t._v(t._s(t.rangesData[e].max))])]),t._v(" "),a("td",{attrs:{width:"120"}},[a("v-chip",{attrs:{color:"#555555",dark:""}},[t._v("\n                            "+t._s(t.getTotalCredits(e))+"\n                        ")])],1),t._v(" "),a("td",{attrs:{width:"120"}},[a("v-chip",{attrs:{color:t.getKPI5Color(t.rangesData[e].min,t.rangesData[e].max,t.getTotalCredits(e),t.getDistinc(e)),dark:""}},[t._v("\n                            "+t._s(t.getKPI5(t.rangesData[e].min,t.rangesData[e].max,t.getTotalCredits(e),t.getDistinc(e)))+"\n                        ")])],1)])})),0)]},proxy:!0}])})],1)],1)};i._withStripped=!0;var n=a(66);a(19),a(26);r.a.use(n.a);var o=new r.a,c=new n.a({icons:{iconfont:"mdi"}});function l(t,e){e=e||",";for(var a=new RegExp("(\\"+e+'|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\'+e+"\\r\\n]*))","gi"),s=[[]],r=null,i=null;r=a.exec(t);){var n=r[1];n.length&&n!==e&&s.push([]),i=r[2]?r[2].replace(new RegExp('""',"g"),'"'):r[3],s[s.length-1].push(i)}return s}var d={name:"App",components:{},data:function(){return{value:"",dialog:null,table:null,categories:null,tab:null,rangesData:{},database:{},sortedDatabase:[],databaseCategories:{},loadingbar:!0,snackbarMsg:"",snackbar:!1,tenantId:-1,tenants:[]}},computed:{message:function(){return this.$store.state.message}},mounted:function(){var t=this,e=this;e.loadingbar=!0,o.$on("onSearch",(function(t){e.search=t})),o.$on("reloadwidget",(function(){e.reload()})),void 0===widget.id?e.tenantDataLoaded([{id:-1}]):requirejs(["DS/i3DXCompassServices/i3DXCompassServices"],(function(e){e.getPlatformServices({platformId:void 0,onComplete:t.tenantDataLoaded})}))},methods:{log:function(t){this.snackbarMsg=t,this.snackbar=!0},filterCertificates:function(t){for(var e=0,a=0,s=function(e,a,s){for(var r=0;r<t.length;++r)if(t[r].Name.toLowerCase()===e.toLowerCase()+" "+a.toLowerCase()&&s<=new Date(t[r].Added))return!0;return!1},r=1;r<this.table.length;++r){var i=new Date,n=this.table[r][14].split(" ")[0].split("/"),o=new Date(n[2],n[0]-1,n[1]),c=this.table[r][13].split(" ")[0].split("/"),l=new Date(c[2],c[1]-1,c[0]);s(this.table[r][4],this.table[r][5],l)?a++:i>o&&(++e,this.table.splice(r++,1))}console.log("Expired: "+e),console.log("Obsolete: "+a)},tenantDataLoaded:function(t){this.tenants=[];for(var e=[],a=0,s=0;s<t.length;s++)void 0!==t[s]["3DSpace"]&&(e.push({value:"".concat(a++),label:"".concat(t[s].platformId," - ").concat(t[s].displayName)}),this.tenants.push(t[s]));widget.addPreference({name:"_CurrentTenantID_",type:"list",label:"Tenant",defaultValue:"0",options:e}),widget.addPreference({name:"_FileKey_",type:"text",label:"File Key",defaultValue:""}),o.$emit("reloadwidget")},getCSRF:function(t,e){var a,s,r=this,i=r.tenants[r.tenantId]["3DSpace"];a=i+"/resources/v1/application/CSRF",s={onComplete:function(e){var a=JSON.parse(e);t(a.csrf.value)},onFailure:function(t){r.log(t),e()}},requirejs(["DS/WAFData/WAFData"],(function(t){t.authenticatedRequest(a,s)}))},getColor:function(t){return t%2==1?"white":"#EFEFEF"},getTotalCredits:function(t){if(!this.databaseCategories||!this.databaseCategories[t])return 0;for(var e=0,a=0;a<this.databaseCategories[t].length;++a){var s=this.databaseCategories[t][a];e+=s.count*s.credits}return e},getDistinc:function(t){if(!this.databaseCategories||!this.databaseCategories[t]||0==this.databaseCategories[t].length)return 0;for(var e=this.databaseCategories[t][0].category,a=0,s=0,r=0;r<this.databaseCategories[t].length;++r){var i=this.databaseCategories[t][r];i.category!==e&&(s+=0!==a?1:0,e=i.category,a=0),a+=i.count&&0!=i.count?1:0}return s+=0!==a?1:0},getKPI5:function(t,e,a,s){return a>=t?a>=e&&s>=5?10:5:0},getKPI5Color:function(t,e,a,s){switch(this.getKPI5(t,e,a,s)){case 10:return"#4b9e6c";case 5:return"#4b839e";default:return"#9e4b4b"}},loadData:function(t){for(var e=0;e<this.databaseCategories.categories.length;++e){this.databaseCategories.categories[e].count=0}if(void 0!==this.databaseCategories[t])for(var a=0;a<this.databaseCategories[t].length;++a)for(var s=this.databaseCategories[t][a],r=0;r<this.databaseCategories.categories.length;++r){var i=this.databaseCategories.categories[r];i.category==s.category&&i.subcategory==s.subcategory&&(i.count=s.count)}},addCategoryItem:function(t,e,a,s){var r=!1,i="categories"===t;if(this.databaseCategories[t]){for(var n=0;n<this.databaseCategories[t].length;++n){var o=this.databaseCategories[t][n];if(o.category===e&&o.subcategory===a)return o.count+=i?0:1,void(r=!0)}r||this.databaseCategories[t].push({category:e,subcategory:a,credits:Number(s.replace(/,/g,".")),count:i?0:1,color:0})}else console.error(t+" doesn't have other licenses?")},getRanges:function(t,e){for(var a=0;a<e.length;++a)if(e[a][0]==t){var s=e[a][1].split(" ET ");return{min:s[0],max:s[1]}}return{min:"NAN",max:"NAN"}},reload:function(){var t=this,e=widget.getPreference("_FileKey_").value,a=new XMLHttpRequest;a.open("GET","https://bcracker.dev/widgets/database_kpi.php?key="+e,!1),a.send(null),this.table=l(a.responseText,";"),a.open("GET","https://bcracker.dev/widgets/obsolete.php?key="+e,!1),a.send(null);var s=JSON.parse(a.responseText);this.filterCertificates(s),a.open("GET","https://bcracker.dev/widgets/cert_category.php?key="+e,!1),a.send(null),this.categories=l(a.responseText,";"),a.open("GET","https://bcracker.dev/widgets/smec.php?key="+e,!1),a.send(null);l(a.responseText,";");a.open("GET","https://bcracker.dev/widgets/ranges.php?key="+e,!1),a.send(null);var i=l(a.responseText,";");this.sortedDatabase.splice(0,this.sortedDatabase.length),this.database={},this.databaseCategories={};for(var n=1;n<this.table.length;n++){var o=this.table[n][1];if(o){for(var c=this.table[n][3].split("[")[1].substring(0,15),d=this.table[n][9],g=!1,h="Brand_Essentials",u="Brand Articulate",b="0,5",f=1;f<this.categories.length;++f)if(this.categories[f][0]===d){h=this.categories[f][1],u=this.categories[f][2],b=this.categories[f][3],g=!0;break}void 0===this.database[o]&&(this.sortedDatabase.push(o),r.a.set(this.database,o,[]),r.a.set(this.databaseCategories,o,[])),g?this.addCategoryItem(o,h,u,b):d.startsWith("SMEC")?this.addCategoryItem(o,"Sales","Sales_SMEC","4"):console.error(d+" doesn't exist in the list.");var p={partnerId:c,certName:d,certExpiration:this.table[n][14],certProfile:this.table[n][11],certAxis:this.table[n][10],certCategory:this.table[n][12],category:h,subcategory:u,credits:b},v=this.getRanges(o,i);r.a.set(this.rangesData,o,v),this.database[o].push(p)}}r.a.set(this.databaseCategories,"categories",[]);for(var C=2;C<this.categories.length;C++){var m=this.categories[C][1],w=this.categories[C][2],y=this.categories[C][3];void 0!==y&&this.addCategoryItem("categories",m,w,y)}for(var _ in this.sortedDatabase.sort((function(e,a){var s=t.database[e].length,r=t.database[a].length;return s<r?1:s>r?-1:0})),this.databaseCategories)if(this.databaseCategories[_].sort((function(t,e){return t.category<e.category?-1:t.category>e.category?1:0})),this.databaseCategories[_].length>0)for(var D=this.databaseCategories[_][0],S=0,x=0;x<this.databaseCategories[_].length;++x)D.category!==this.databaseCategories[_][x].category&&++S,(D=this.databaseCategories[_][x]).color=S}}},g=(a(37),a(39)),h=a(40),u=a.n(h),b=a(64),f=a(67),p=a(68),v=a(65),C=Object(g.a)(d,i,[],!1,null,null,null);u()(C,{VApp:b.a,VCard:f.a,VChip:p.a,VSimpleTable:v.a}),C.options.__file="src/components/app.vue";var m=C.exports,w=a(57);r.a.use(w.a);var y=new w.a.Store({state:{},mutations:{},getters:{}});e.default=function(){widget.addEvent("onLoad",(function(){s.b.disableCSS(!0),window.title="Tablue Vue",widget.setTitle(window.title),new r.a({store:y,vuetify:c,render:function(t){return t(m)}}).$mount("app")})),widget.addEvent("onRefresh",(function(){o.$emit("reloadwidget")})),widget.addEvent("onSearch",(function(t){o.$emit("onSearch",t)})),widget.addEvent("onResetSearch",(function(){o.$emit("onSearch","")}))}},37:function(t,e,a){"use strict";var s=a(14);a.n(s).a},38:function(t,e,a){(t.exports=a(5)(!1)).push([t.i,"\nhtml, body {\r\n    overflow-y: auto !important;\r\n    width: 100%;\r\n    padding: 0;\r\n    margin: 0;\r\n    background-color:#ffffff;\n}\r\n",""])}}]);